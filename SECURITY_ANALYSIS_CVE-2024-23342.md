# Security Analysis: CVE-2024-23342 (ecdsa Minerva Timing Attack)

**Date:** February 2, 2026
**Alert:** GitHub Dependabot #22
**Severity:** High
**Status:** ‚úÖ NOT EXPLOITABLE - Safe to Dismiss

---

## üìã Vulnerability Summary

**CVE:** CVE-2024-23342
**GHSA:** GHSA-wj6h-64fc-37mp
**Package:** `ecdsa` (v0.19.1)
**CVSS Score:** 7.4 (High)
**Vector:** CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N

### Description
The `python-ecdsa` library is vulnerable to a Minerva timing attack on the P-256 elliptic curve. An attacker who can measure the timing of ECDSA signature operations may be able to extract the internal nonce, potentially leading to private key discovery.

**Affected Operations:**
- ECDSA signature generation (`SigningKey.sign_digest()`)
- ECDSA key generation
- ECDH (Elliptic Curve Diffie-Hellman) operations

**Not Affected:**
- ECDSA signature verification
- Other cryptographic operations

### Important Notes from Maintainers
> "The python-ecdsa project considers side channel attacks out of scope for the project and there is no planned fix."
> ‚Äî python-ecdsa Security Advisory

**Patched Version:** None available (and none planned)

---

## üîç Investigation: How ISRS Uses `ecdsa`

### Dependency Chain
```
requirements.txt
  ‚îî‚îÄ python-jose[cryptography]==3.4.0
      ‚îî‚îÄ ecdsa==0.19.1 (transitive dependency)
```

The `ecdsa` package is **NOT directly used** by ISRS. It's pulled in as a transitive dependency of `python-jose`.

### ISRS JWT Configuration

**File:** `/backend-python/app/services/auth_service.py`

**Usage:**
```python
from jose import jwt, JWTError

# JWT token creation
encoded_jwt = jwt.encode(
    to_encode,
    settings.SECRET_KEY,
    algorithm=settings.JWT_ALGORITHM  # HS256
)

# JWT token verification
payload = jwt.decode(
    token,
    settings.SECRET_KEY,
    algorithms=[settings.JWT_ALGORITHM]  # HS256
)
```

**File:** `/backend-python/app/config.py`

**Configuration:**
```python
JWT_ALGORITHM: str = "HS256"
```

---

## ‚úÖ Security Assessment: NOT EXPLOITABLE

### Why This Vulnerability Does NOT Affect ISRS

1. **Algorithm Used: HS256 (HMAC-SHA256)**
   - ISRS uses HS256 for JWT signing
   - HS256 is a **symmetric** algorithm using HMAC
   - HS256 does **NOT use ECDSA** or elliptic curves
   - The vulnerability affects **ECDSA algorithms only**

2. **No ECDSA Operations**
   - ISRS never calls ECDSA signature functions
   - No P-256 curve operations in codebase
   - No ECDH key exchanges
   - `ecdsa` package code is never executed

3. **Transitive Dependency Only**
   - `ecdsa` is installed but never imported
   - No code path leads to ECDSA functions
   - Package is only present to satisfy python-jose dependency tree

### Verification

**Grep for ECDSA usage:**
```bash
$ grep -r "ecdsa\|ES256\|ES384\|ES512" backend-python/app/
# Result: No matches (only HS256 found)
```

**JWT Algorithm Check:**
```bash
$ grep "JWT_ALGORITHM" backend-python/app/config.py
JWT_ALGORITHM: str = "HS256"
```

**Python-jose Import Check:**
```bash
$ grep -r "from jose import" backend-python/app/
app/services/auth_service.py:from jose import jwt, JWTError
# Only imports jwt module, not ECDSA functions
```

---

## üéØ Recommendations

### Immediate Action: Dismiss Alert ‚úÖ

**Rationale:**
- Vulnerability does not affect ISRS
- No ECDSA operations in codebase
- HS256 (HMAC) is used, not ECDSA
- False positive from dependency scanner

**Dismissal Reason:** "Vulnerable code not used"

**Dismissal Comment:**
```
This vulnerability affects ECDSA signature operations in the python-ecdsa library.
ISRS uses HS256 (HMAC-SHA256) for JWT tokens, not ECDSA algorithms.
The ecdsa package is a transitive dependency of python-jose but is never used.
No ECDSA operations are performed anywhere in the codebase.
```

### Medium-Term: Consider Migration (Optional)

While the current setup is secure, consider migrating from `python-jose` to a more actively maintained alternative:

**Option 1: PyJWT** (Recommended)
```python
# Replace: python-jose[cryptography]==3.4.0
# With:    PyJWT[crypto]==2.8.0

# Benefits:
# - More actively maintained
# - Better performance
# - Fewer dependencies
# - No ecdsa dependency
```

**Option 2: Authlib**
```python
# Alternative: authlib==1.3.0

# Benefits:
# - Modern OAuth/JWT library
# - Active development
# - Broader feature set
```

**Migration Effort:** ~2 hours
- Update requirements.txt
- Update auth_service.py imports
- Test JWT generation/verification
- No breaking changes to API

---

## üìä Risk Analysis

### Current Risk: NONE ‚úÖ

| Factor | Assessment | Notes |
|--------|------------|-------|
| **Exploitability** | Not applicable | ECDSA code never executed |
| **Attack Complexity** | N/A | Requires ECDSA operations |
| **Impact** | None | No ECDSA in use |
| **Likelihood** | 0% | Impossible to exploit |
| **Overall Risk** | **NONE** | Safe to dismiss |

### Future Considerations

**If** ISRS were to use ECDSA in the future:
- ‚ö†Ô∏è Do NOT use python-ecdsa for production signatures
- ‚úÖ Use cryptography library instead (timing-attack resistant)
- ‚úÖ Use PyJWT with cryptography backend
- ‚úÖ Consider hardware security modules (HSM) for key operations

---

## üîí Best Practices Verification

### Current Security Posture ‚úÖ

1. **JWT Algorithm Hardcoded**
   ```python
   JWT_ALGORITHM: str = "HS256"  # ‚úÖ Good - prevents algorithm confusion
   ```

2. **Algorithm Validation in Decode**
   ```python
   jwt.decode(token, key, algorithms=["HS256"])  # ‚úÖ Good - explicit allow-list
   ```

3. **No "none" Algorithm**
   - ‚úÖ Not vulnerable to "none" algorithm attack
   - ‚úÖ Algorithm is explicitly specified

4. **Secret Key Security**
   - ‚úÖ Secret key stored in environment variable
   - ‚úÖ Not hardcoded in source code

### Recommendations Already Followed ‚úÖ

From `requirements.txt` comments:
```python
# NOTE: python-jose pulls ecdsa as optional dependency (CVE-2024-23342 - Minerva timing attack).
# No fix available. Not exploitable here: we use HS256 (HMAC), not ECDSA algorithms.
python-jose[cryptography]==3.4.0
```

This shows previous security review was conducted and vulnerability was already assessed as not applicable.

---

## üìù Action Items

### Immediate (Today)
- [x] Review Dependabot alert
- [x] Verify ECDSA not used
- [x] Document security analysis
- [ ] **Dismiss alert with justification**

### Short-Term (This Week)
- [ ] Add to `.github/dependabot.yml` ignore list (optional)
- [ ] Update security documentation

### Medium-Term (Next Quarter)
- [ ] Consider migrating to PyJWT
- [ ] Evaluate removing python-jose dependency
- [ ] Review all cryptographic dependencies

---

## üö® When to Re-evaluate

**Re-open this analysis if:**
1. ISRS starts using ECDSA algorithms (ES256, ES384, ES512)
2. ISRS implements ECDH key exchange
3. New code imports from `ecdsa` package directly
4. JWT_ALGORITHM changes from HS256

**Otherwise:** Safe to dismiss permanently

---

## üìö References

### Vulnerability Details
- **GHSA Advisory:** https://github.com/tlsfuzzer/python-ecdsa/security/advisories/GHSA-wj6h-64fc-37mp
- **CVE Details:** https://nvd.nist.gov/vuln/detail/CVE-2024-23342
- **Minerva Attack:** https://minerva.crocs.fi.muni.cz
- **python-ecdsa Security:** https://github.com/tlsfuzzer/python-ecdsa/blob/master/SECURITY.md

### ISRS Code References
- JWT Implementation: `/backend-python/app/services/auth_service.py:7-77`
- JWT Configuration: `/backend-python/app/config.py:25`
- Requirements: `/backend-python/requirements.txt:16`

---

## üéì Technical Deep Dive

### What is a Minerva Timing Attack?

A Minerva timing attack exploits timing variations in cryptographic operations:

1. **Attacker measures** the time taken for ECDSA signature operations
2. **Statistical analysis** reveals information about the secret nonce
3. **Nonce leakage** can lead to private key recovery
4. **Requires many samples** (thousands of signatures)

### Why HS256 is Immune

**HS256 (HMAC-SHA256):**
- Uses symmetric key cryptography
- Based on hash functions (SHA-256)
- No elliptic curve operations
- No nonce generation
- Constant-time implementation (in OpenSSL)

**ECDSA (ES256):**
- Uses asymmetric key cryptography
- Based on elliptic curve math
- Requires random nonce per signature
- Nonce leakage = private key compromise
- Vulnerable to timing attacks

---

## ‚úÖ Conclusion

**Security Assessment:** SAFE ‚úÖ

The CVE-2024-23342 vulnerability in the `ecdsa` package does NOT affect ISRS because:

1. ‚úÖ ISRS uses HS256 (HMAC), not ECDSA
2. ‚úÖ No ECDSA operations in codebase
3. ‚úÖ `ecdsa` package is never imported or used
4. ‚úÖ Transitive dependency only (from python-jose)

**Recommendation:** Dismiss Dependabot alert #22 with reason "Vulnerable code not used"

**Long-term:** Consider migrating to PyJWT to eliminate unnecessary dependency

---

**Analysis Date:** February 2, 2026
**Analyst:** Security Review Team
**Status:** APPROVED FOR DISMISSAL
